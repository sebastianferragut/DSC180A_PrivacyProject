<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privacy Agent Dashboard</title>
    <link rel="stylesheet" href="../style2.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script type="module" src="../global.js"></script>
    <script type="module" src="../treemap.js"></script>
</head>

<body>
    <!-- Top Navigation Bar -->
    <nav class="navbar" id="navbar">
        <h1>Privacy Agent Dashboard</h1>
    </nav>

    <!-- Sidebar and Main Content -->
    <div class="container">
        <!-- Left Sidebar Navigation -->
        <aside class="sidebar">
            <a href="#section1">Cross-platform privacy</a>
            <a href="#section2">Your recommendations</a>
        </aside>

        <!-- Main Content -->
         <!-- Main Content -->
        <main class="dashboard">
            <!-- Treemap Visualization -->
            <section class="panel treemap-section">
            <div class="treemap-controls">
                <div class="treemap-control-row">
                <label>
                    Sizing Metric:
                    <select id="sizingMetric">
                    <option value="count">Count (1 per setting)</option>
                    <option value="actionable">Actionable only</option>
                    <option value="risk-weighted">Risk-weighted</option>
                    <option value="clicks">Number of clicks</option>
                    </select>
                </label>
                <label>
                    State Type:
                    <select id="stateTypeFilter">
                    <option value="all">All</option>
                    <option value="actionable">Actionable</option>
                    <option value="navigational">Navigational</option>
                    <option value="unknown">Unknown</option>
                    </select>
                </label>
                <label for="platformFilter">
                    Platform:
                    <div class="custom-dropdown" id="platformFilterDropdown">
                        <div class="dropdown-trigger" id="platformFilterTrigger">
                            <span class="dropdown-label">All platforms</span>
                            <span class="dropdown-caret">▼</span>
                        </div>
                        <div class="dropdown-menu" id="platformFilterMenu">
                            <ul class="dropdown-list" id="platformFilterList"></ul>
                        </div>
                    </div>
                </label>
                <label>
                    Search:
                    <input type="text" id="searchBox" placeholder="Search settings..." />
                </label>
                </div>
                <div class="breadcrumbs" id="breadcrumbs">
                <span class="breadcrumb-item active" data-path="">All</span>
                </div>
            </div>
            <div id="treemapAreaCallout" class="treemap-callout"></div>
            <div id="treemapContainer">
                <!-- Setting Details Panel -->
                <div id="settingDetails" class="hidden">
                <div class="details-header">
                    <h3 id="detailsTitle">Setting Details</h3>
                    <p id="detailsSubtitle" class="details-subtitle"></p>
                    <button id="detailsClose" class="details-close" aria-label="Close">×</button>
                </div>
                <div class="details-body">
                    <div class="details-row">
                    <strong>Description:</strong>
                    <p id="detailsDescription"></p>
                    </div>
                    <div class="details-row">
                    <strong>State:</strong>
                    <p id="detailsState"></p>
                    </div>
                    <div class="details-row">
                    <strong>Actionability:</strong>
                    <p id="detailsActionable"></p>
                    </div>
                    <div class="details-row">
                    <strong>Risk:</strong>
                    <p id="detailsRisk"></p>
                    </div>
                </div>
                <div class="details-footer">
                    <a id="detailsOpenUrl" href="#" target="_blank" rel="noopener noreferrer" class="details-link">Open setting page →</a>
                </div>
                </div>
            </div>
            <div id="treemapLegend" class="treemap-legend">
                <!-- Legend will be populated by JavaScript -->
            </div>
            </section>

            <!-- Additional Charts Section -->
            <section class="panel charts-section">
            <div id="belowTreemapRow" class="charts-container">
                <div class="chart-panel">
                <h3>Settings by Platform and Type</h3>
                <p class="chart-subtitle">Updates to match the current treemap view (zoom + filters).</p>
                <div id="stackedPlatformChart"></div>
                </div>
                <div class="chart-panel">
                <h3>Area Share (Current View)</h3>
                <p class="chart-subtitle">Shows platform share within the current view using the same sizing metric as the treemap.</p>
                <div id="pieAreaChart"></div>
                </div>
            </div>
            </section>
        </main>
    </div>
</body>
</html>